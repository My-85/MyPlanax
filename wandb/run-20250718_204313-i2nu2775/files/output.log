Using separate learning rates - Actor: 0.0003, Critic: 0.003
Traceback (most recent call last):
  File "/home/dqy/NeuralPlanex/Planax_lczh/Planax_lczh/2v2 mappo/AeroPlanax_multi_combat_2v2/main_train_hierarchy_combat_new.py", line 157, in <module>
    (actor_network, critic_network), (ac_train_state, cr_train_state), start_epoch = init_network(config, DEFUALT_DIMS)
  File "/home/dqy/NeuralPlanex/Planax_lczh/Planax_lczh/2v2 mappo/AeroPlanax_multi_combat_2v2/networks/mappoRNN_discrete.py", line 173, in init_network
    actor_network_params = actor_network.init(_rng_actor, ac_init_hstate, ac_init_x)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 2447, in init
    _, v_out = self.init_with_output(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 2299, in init_with_output
    return init_with_output(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/scope.py", line 1115, in wrapper
    return apply(fn, mutable=mutable, flags=init_flags)(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/scope.py", line 1079, in wrapper
    y = fn(root, *args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 3088, in scope_fn
    return fn(module.clone(parent=scope, _deep_clone=True), *args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 699, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 1216, in _call_wrapped_method
    y = run_fun(self, *args, **kwargs)
  File "/home/dqy/NeuralPlanex/Planax_lczh/Planax_lczh/2v2 mappo/AeroPlanax_multi_combat_2v2/networks/mappoRNN_discrete.py", line 82, in __call__
    hidden, embedding = ScannedRNN()(hidden, rnn_in)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/transforms.py", line 433, in wrapped_fn
    return trafo_fn(module_scopes, *args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/lift.py", line 328, in wrapper
    y, out_variable_groups_xs_t = fn(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/lift.py", line 1032, in inner
    broadcast_vars, (carry_vars, c), (ys, scan_vars) = scanned(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/axes_scan.py", line 152, in scan_fn
    _, out_pvals, _ = pe.trace_to_jaxpr_nounits(f_flat, in_pvals)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/profiler.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 681, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/axes_scan.py", line 124, in body_fn
    broadcast_out, c, ys = fn(broadcast_in, c, *xs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/lift.py", line 1013, in scanned
    c, y = fn(scope, c, *args)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/transforms.py", line 409, in core_fn
    res = prewrapped_fn(cloned, *args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 699, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 1216, in _call_wrapped_method
    y = run_fun(self, *args, **kwargs)
  File "/home/dqy/NeuralPlanex/Planax_lczh/Planax_lczh/2v2 mappo/AeroPlanax_multi_combat_2v2/networks/scannedRNN.py", line 51, in __call__
    new_rnn_state, y = cell(rnn_state, ins)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 699, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 1216, in _call_wrapped_method
    y = run_fun(self, *args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/recurrent.py", line 588, in __call__
    r = self.gate_fn(dense_i(name='ir')(inputs) + dense_h(name='hr')(h))
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 699, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 1216, in _call_wrapped_method
    y = run_fun(self, *args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/linear.py", line 251, in __call__
    kernel = self.param(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/linen/module.py", line 1872, in param
    v = self.scope.param(name, init_fn, *init_args, unbox=unbox, **init_kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/flax/core/scope.py", line 968, in param
    value = init_fn(self.make_rng('params'), *init_args, **init_kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/nn/initializers.py", line 610, in init
    A = random.normal(key, matrix_shape, dtype)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/random.py", line 700, in normal
    return _normal(key, shape, dtype)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 338, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr, attrs_tracked = _python_pjit_helper(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 188, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **p.params)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/core.py", line 2803, in bind
    return self.bind_with_trace(top_trace, args, params)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/core.py", line 442, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/core.py", line 955, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 1738, in _pjit_call_impl
    return xc._xla.pjit(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 1714, in call_impl_cache_miss
    out_flat, compiled = _pjit_call_impl_python(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 1644, in _pjit_call_impl_python
    ).compile(compile_options)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2345, in compile
    executable = UnloadedMeshExecutable.from_hlo(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2854, in from_hlo
    xla_executable = _cached_compilation(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 2666, in _cached_compilation
    xla_executable = compiler.compile_or_get_cached(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/compiler.py", line 434, in compile_or_get_cached
    return _compile_and_write_cache(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/compiler.py", line 662, in _compile_and_write_cache
    executable = backend_compile(
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/profiler.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/compiler.py", line 267, in backend_compile
    return backend.compile(built_c, compile_options=options)
KeyboardInterrupt
