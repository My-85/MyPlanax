Using separate learning rates - Actor: 0.0003, Critic: 0.003
make_train(): ENABLE_CRITIC: True VS_BASELINE: True
检测到AeroPlanaxHierarchicalCombatEnv拥有自定义的train callback！
EnvStep=0     EpisodeLength=360.04  Return=-1353.29
  Victory Breakdown: Complete=0.006 Great=0.003 Normal=0.000 Narrow=0.000 Failure=0.991
  Total Victory Rate=0.009 AliveCount= 0.014 BloodAdvantage= -177.65 EnemiesLocked= 0.00
  EnemiesKilled/Episode=157.00
  Legacy: SimpleSuccess=0.009 WeakSuccess=0.000 WinRate=0.009
--------------------------------------------------------------------------------
EnvStep=1     EpisodeLength=418.31  Return=-1389.00
  Victory Breakdown: Complete=0.007 Great=0.005 Normal=0.000 Narrow=0.000 Failure=0.989
  Total Victory Rate=0.011 AliveCount= 0.018 BloodAdvantage= -180.15 EnemiesLocked= 0.00
  EnemiesKilled/Episode=128.00
  Legacy: SimpleSuccess=0.011 WeakSuccess=0.000 WinRate=0.011
--------------------------------------------------------------------------------
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dqy/NeuralPlanex/Planax_lczh/Planax_lczh/2v2 mappo/AeroPlanax_multi_combat_2v2/main_train_hierarchy_combat_new.py", line 171, in <module>
    out = train_jit(rng, (ac_train_state, cr_train_state), start_epoch)
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: CustomCall failed: CpuCallback error: Traceback (most recent call last):
  File "/home/dqy/NeuralPlanex/Planax_lczh/Planax_lczh/2v2 mappo/AeroPlanax_multi_combat_2v2/main_train_hierarchy_combat_new.py", line 171, in <module>
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 338, in cache_miss
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 188, in _python_pjit_helper
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/core.py", line 2803, in bind
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/core.py", line 442, in bind_with_trace
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/core.py", line 955, in process_primitive
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 1738, in _pjit_call_impl
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 1714, in call_impl_cache_miss
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/pjit.py", line 1668, in _pjit_call_impl_python
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/profiler.py", line 333, in wrapper
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 1278, in __call__
  File "/home/dqy/anaconda3/envs/NeuralPlanex/lib/python3.10/site-packages/jax/_src/interpreters/mlir.py", line 2767, in _wrapped_callback
KeyboardInterrupt:
